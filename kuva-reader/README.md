# Reader for Kuva Space images

The reader project allows the reading of Kuva Space products from any part of its processing chain.

The Kuva Space images are in GeoTIFF format. The products consist of an image or multiple 
images along with its metadata to give all the necessary information to use the products. 
The metadata lives either in a Kuva Space database, or alternatively in a sidecar JSON file. 

This library allows the reading of the image GeoTIFFs into `xarray.Dataset` objects that 
allow convenient raster manipulations, along with their `kuva-metadata` metadata objects.


# Table of Contents

- [Processing levels](#processing-levels)
- [Special tags](#special-tags)
- [Installation](#installation)
- [Tests](#tests)
- [Contributing](#contributing)
- [Configuration](#configuration)
- [Contact information](#contact-information)
- [License](#license)

# Processing levels

Currently the reader supports the following processing levels for Kuva products:

- **L0**: Radiometrically corrected frames as TOA radiance
- **L1AB**: Band-aligned product formed from multiple L0 products
- **L1C**: Georeferences and orthorectified L1 product
- **L2A**: Atmospherically corrected product as BOA reflectance

# Special tags
All images generated by Kuva Space should have the following special tags added to the
geotiff metadata.
- `_KUVA_PRODUCT_LEVEL`: A string, e.g, `"0"` describing the level of the product.
- `_KUVA_PRODUCT_ID`: The id on the database for the product associated with the geotiff.

This makes it very easy to pinpoint what product we are dealing with and works around
the issue that our images are not a monolithic entity but rather just folders that can
be messed with.

# Installation

### Requirements

- Python 3.10, preferably within a virtual environment

### Installation from source

Installation from source is simply done with poetry. Be sure to activate your Python 
virtual environment and run the following command in this project's root:

```sh
# If poetry is not installed in your virtual environment:
pip install poetry
```

```sh
# Install the package locally
poetry install
```

Pypi installation coming soon.

# Tests

Units tests aimed for the package developers are available with Pytest. Running pytest 
requires the dev dependencies of the project. They can be installed with

```sh
# Test dependency installation
poetry install --with dev
```

Then, tests can be run simply with pytest in the project's root folder

```sh
# Running tests
poetry run pytest
```

# Contributing

Please follow the guidelines in [CONTRIBUTING.md](../CONTRIBUTING.md).

Also, please follow our [Code of Conduct](../CODE_OF_CONDUCT.md) while discussing in the 
issues and pull requests.

# Contact information

For questions or support, please open an issue. If you have been given a support contact, 
feel free to send them an email explaining your issue.

# License

The `kuva-reader` project software is under the [MIT license](../LICENSE.md).

# Status of unit tests

[![Unit tests for kuva-reader](https://github.com/KuvaSpace/kuva-data-processing/actions/workflows/test-kuva-reader.yml/badge.svg)](https://github.com/KuvaSpace/kuva-data-processing/actions/workflows/test-kuva-reader.yml)
